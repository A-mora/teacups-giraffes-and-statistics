<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Covariance and Correlation</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Lora:400,400i,700,700i" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,200i,300,300i,400,400i,600,600i,700,700i,900,900i" rel="stylesheet">
<link href="style.css" rel="stylesheet">

  <div class="image-descript"> 
		<img class="big_image" src="log.png">
		<div class="image-text">
			<div class="lil-image-text">A Tale of Two Variables:</div>
			<div class="big-image-text"><strong>COVARIANCE & CORRELATION</strong></div>
		</div>
  </div>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify" style="position: static;">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Statistics with R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Modules
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="BellCurve.html">Intro to the Normal Distribution</a>
    </li>
    <li>
      <a href="mean.html">Mean, Median, Mode</a>
    </li>
    <li>
      <a href="Variance.html">Spread of the Data</a>
    </li>
    <li>
      <a href="covariance_and_correlation.html">Covariance and Correlation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore"></h1>

</div>


<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
<script src="https://cdn.datacamp.com/datacamp-light-latest.min.js"></script>
<div class="alert alert-info">
<strong>Module learning objectives:</strong>
<ol>
<li>
Create a scatterplot using ggplot
</li>
<li>
Identify the similarities and differences between calculating the variance and covariance
</li>
<li>
Write a function for the covariance and Pearson’s correlation coefficient
</li>
<li>
Interpret the meaning behind Pearson’s correlation correlation
<li>
Describe the purpose of dividing by the product of the standard deviations when calculating the correlation.
</li>
</ol>
</div>
<div id="gathering-data-on-another-variable" class="section level1">
<h1>Gathering data on another variable</h1>
<p>Over the course of your time on the islands, you notice that the teacup giraffes seem to have an affinity for celery, which you begin to use to entice them with in order to have them come close enough for a height measurment. One of the small ones had eaten so much of it! You decide to quantify how much celery each of the giraffes consumed to see if there is any relationship to height.</p>
<p>You systematically measure the amout of celery eaten and add it to your log of data, which is stored as a dataframe called <code>giraffe_data</code>.</p>
<p>We can check out the first entries of the data by using the <code>head( )</code> command:</p>
<pre class="r"><code>head(giraffe_data)</code></pre>
<pre><code>##     Heights Celery_Eaten
## 1  7.038865     16.36129
## 2 13.154339     10.72354
## 3  8.086511     17.16798
## 4  8.159990     22.52115
## 5  6.004716     13.77993
## 6  9.455408     16.92304</code></pre>
<p>It’s difficult to get an idea if there’s any relationship by just looking at the values. We learn so much more from creating a plot. Let’s revisit our newly acquired ggplot skills to make a scatter plot.</p>
<p>A lot of the code used <a href="https://dcossyleon.github.io/cars/BellCurve.html">previously</a> can be re-used for the scatterplot. Two main differences are the following:</p>
<ol style="list-style-type: decimal">
<li><p>Because we now have an additional variable, we need to <strong>assign a <code>y =</code> for the <code>aes( )</code> command within <code>ggplot( )</code></strong> Create the plot so that <code>Celery_Eaten</code> will be on the y-axis.</p></li>
<li><p><strong>Add (<code>+</code>) a <code>geom_point( )</code></strong> element instead of <code>geom_hist( )</code></p></li>
</ol>
<p>Also, we will add lines to our plot, representing the mean of each variable. Here’s how you’ll do that:</p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Add a horizontal line</strong> by adding (<code>+</code>) a <code>geom_hline( )</code> component. This takes the argument <code>yintercept =</code>, which is where you will specify the value for where the horitzontal line should cross the y-intercept.
<ul>
<li>Since we want this to cross at the mean, you can use the <code>mean( )</code> function instead of specifying a numeric value directly.</li>
</ul></li>
<li><strong>Add a vertical line</strong> by following the same structure as above but using <code>geom_vline( )</code> and <code>xintercept =</code> instead. This vertical line will represent the mean (<span class="math inline">\({\bar{x}}\)</span>) of the heights.</li>
</ol>
<p>Construct a scatterplot of the data using the window below:</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyKVxueDEgPC0gcm5vcm0oNTAsIDEwLCAyKVxuXG54MiA8LSBzY2FsZShtYXRyaXgocm5vcm0oNTApLCBuY29sPTEpKVxueDEyIDwtIGNiaW5kKHNjYWxlKHgxKSx4MilcblxuYzEgPC0gdmFyKHgxMilcbmNob2wxIDwtIHNvbHZlKGNob2woYzEpKVxubmV3eCA8LSAgeDEyICUqJSBjaG9sMVxuXG5uZXdjIDwtIG1hdHJpeChjKDEsLTAuNTIsIC0wLjUyLCAxKSwgbmNvbD0yKVxuY2hvbDIgPC0gY2hvbChuZXdjKVxuZmluYWx4IDwtIG5ld3ggJSolIGNob2wyICogc2QoeDEpICsgbWVhbih4MSlcblxuZmluYWx4WywyXSA8LSAoMipmaW5hbHhbLDJdLTUpXG5cbmdpcmFmZmVfZGF0YSA8LSBmaW5hbHhcbmNvbG5hbWVzKGdpcmFmZmVfZGF0YSkgPC0gYyhcIkhlaWdodHNcIiwgXCJDZWxlcnlfRWF0ZW5cIilcblxuZ2lyYWZmZV9kYXRhIDwtIGFzLmRhdGEuZnJhbWUoZ2lyYWZmZV9kYXRhKSIsInNhbXBsZSI6IiMgQ3JlYXRlIGEgc2NhdHRlcnBsb3QgYmVsb3ciLCJzb2x1dGlvbiI6InAgPC0gIGdncGxvdChkYXRhPSBnaXJhZmZlX2RhdGEsIGFlcyh4PSBIZWlnaHRzLCB5PUNlbGVyeV9FYXRlbikpICtcbiAgZ2VvbV9wb2ludCgpICsgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gbWVhbihnaXJhZmZlX2RhdGEkSGVpZ2h0cykpICsgZ2VvbV9obGluZSh5aW50ZXJjZXB0ID0gbWVhbihnaXJhZmZlX2RhdGEkQ2VsZXJ5X0VhdGVuKSlcblxucCJ9
</div>
<p>Great, now you have a scatter plot! But recalling the email from your advisor the last time you plotted data– you decide you’d like to customize the look of the plot the same way you did when you created the ggplot histogram.</p>
<p>Play around with some aesthetics in the window below, and then run the solution to see what we chose.</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyKVxueDEgPC0gcm5vcm0oNTAsIDEwLCAyKVxuXG54MiA8LSBzY2FsZShtYXRyaXgocm5vcm0oNTApLCBuY29sPTEpKVxueDEyIDwtIGNiaW5kKHNjYWxlKHgxKSx4MilcblxuYzEgPC0gdmFyKHgxMilcbmNob2wxIDwtIHNvbHZlKGNob2woYzEpKVxubmV3eCA8LSAgeDEyICUqJSBjaG9sMVxuXG5uZXdjIDwtIG1hdHJpeChjKDEsLTAuNTIsIC0wLjUyLCAxKSwgbmNvbD0yKVxuY2hvbDIgPC0gY2hvbChuZXdjKVxuZmluYWx4IDwtIG5ld3ggJSolIGNob2wyICogc2QoeDEpICsgbWVhbih4MSlcblxuZmluYWx4WywyXSA8LSAoMipmaW5hbHhbLDJdLTUpXG5cbmdpcmFmZmVfZGF0YSA8LSBmaW5hbHhcbmNvbG5hbWVzKGdpcmFmZmVfZGF0YSkgPC0gYyhcIkhlaWdodHNcIiwgXCJDZWxlcnlfRWF0ZW5cIilcblxuZ2lyYWZmZV9kYXRhIDwtIGFzLmRhdGEuZnJhbWUoZ2lyYWZmZV9kYXRhKSIsInNhbXBsZSI6IiMgQ3VzdG9taXplIHlvdXIgZ2dwbG90Iiwic29sdXRpb24iOiJwIDwtICBnZ3Bsb3QoZGF0YT0gZ2lyYWZmZV9kYXRhLCBhZXMoeD0gSGVpZ2h0cywgeT1DZWxlcnlfRWF0ZW4pKSArXG4gIGdlb21fcG9pbnQoc2l6ZSA9IDMpICsgZ2VvbV92bGluZSh4aW50ZXJjZXB0ID0gbWVhbihnaXJhZmZlX2RhdGEkSGVpZ2h0cyksIGNvbD1cImdyZXk1MFwiLCBsaW5ldHlwZT1cImRhc2hlZFwiLCBzaXplID0gMikgKyBnZW9tX2hsaW5lKHlpbnRlcmNlcHQgPSBtZWFuKGdpcmFmZmVfZGF0YSRDZWxlcnlfRWF0ZW4pLCBjb2w9IFwiZ3JleTgxXCIsIGxpbmV0eXBlPVwiZGFzaGVkXCIsIHNpemU9IDIpXG5cbnAgPC0gcCArIHRoZW1lX2xpZ2h0KCkgKyB0aGVtZShwYW5lbC5ib3JkZXIgPSBlbGVtZW50X2JsYW5rKCksIHBhbmVsLmdyaWQubWlub3I9ZWxlbWVudF9ibGFuaygpKVxuXG5wIn0=
</div>
Looking at the scatterplot, there seems to be a relationship, but you will need to quantify this more formally to be sure.
<div style="margin-bottom:50px">


</div>
<div id="covariance" class="section level1">
<h1>Covariance</h1>
<p>How can the relationship between two variables (and its strength) can be quantified? This can be done by assessing how the two variables change together– one such measure is the <strong>covariance</strong>.</p>
<p>The covariance elegantly combines the deviations of observations from two different variables into a single value.</p>
<ol style="list-style-type: decimal">
<li>As we did for the variance, we begin by measuring how far each observation lies from the mean. But unlike the calcuation for the variance, each observation now includes two variables (each with its own mean) that we need to account for. We will need to <strong>calculate the observation’s distance from each variable’s mean</strong>. We call each distance the <strong>deviation</strong> scores on x and on y, respectively. Like the variance, the observation can fall above or below the mean, and as a result the corresponding deviation score will have either a positive or negative sign.</li>
</ol>
<p>We observe this below with a subset of 5 points from our scatterplot. Positive deviations are shown in red, negative deviations in blue.</p>
<center>
<img src="points.png" width="650" />
</center>
<p>Why do we use the deviations? Because we want to know whether the x-values and y-values move together with respect to their means or not’. For example, when an observation’s deviation on x is above <span class="math inline">\(\bar{x}\)</span>, will its deviation on y also be above <span class="math inline">\(/bar{y}\)</span>? Using this line of thought, we can begin to systematically characterize how “together” the x and y values will change as we move from one observation to the next.</p>
<div id="crossproduct" class="section level2">
<h2>Crossproduct</h2>
<p>After obtaining the deviation scores, we need to combine them into a single measure. We do not do not simply combine the deviation scores themselves by adding (please see the <a href="Variance.html">page about the variance</a> for a discussion of why this is). Instead, we take both deviation scores and from the same observation and multiply them together to create a “shape”. (Analagous to when we multiplied a single deviation score by itself to create a “square” in the variance calculation).</p>
<p><strong>NOTE:</strong> The resulting value is now on the order of a squared term. This will become important later.</p>
<ol start="2" style="list-style-type: decimal">
<li><strong>Multiply the two deviation scores.</strong> This is called the <strong>crossproduct</strong>. The shapes created by the crossproduct will serve as the squared terms that we can then use in the next step to sum and summarize the deviations into a single value.</li>
</ol>
<div style="margin-bottom:50px">

</div>
<span class="math display" id="eq:equation1">\[\begin{equation}
 \tag{1}
 \Large (x_i - \mu_{x})(y_i - \mu_{y})
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
</div>
<div id="lets-explore-the-attributes-of-the-crossproduct" class="section level2">
<h2>Let’s explore the attributes of the crossproduct:</h2>
<ul>
<li><p>First, we should note that the <strong>overall sign</strong> of the crossproduct will depend on whether or not the two x- and y- values from the same observation move in the same directions relative to their means. This will either create “negative” shapes (shown in blue) or “positive” shapes (in red). A third outcome is that the crossproduct could also be 0 – this will occur when an observation falls on the mean (that deviation score would be 0).</p></li>
<li><p>Second, the <strong>magnitude of the crossproduct</strong> will scale with the absolute value of the deviation scores. In other words, the further away both deviation scores are from their means, the larger the area will be of shapes they create. In general, the larger the magnitude the crossproduct the more strongly the two variables move together.</p></li>
</ul>
<center>
<img src="points1.png" style="width:60.0%" />
</center>
<p>The animation below shows the “construction” of the crossproducts from the 5 observations we have been following:</p>
<p><img src="covariance_and_correlation_files/figure-html/unnamed-chunk-13-.gif" width="691.2" style="display: block; margin: auto;" /></p>
<ol start="3" style="list-style-type: decimal">
<li><strong>Sum the crossproducts</strong> As we add the crossproducts, some of the “negative” and “positive” values of the shapes will cancel each other out. This is okay because this tells us important information about our two variables. If the negative and positive shapes cancel each other out completely, it would mean that there was no relationship between the two variables. The sum of the crossproduct gives us a single number. The equation is shown below.</li>
</ol>
<div style="margin-bottom:50px">

</div>
<span class="math display" id="eq:equation2">\[\begin{equation}
 \tag{2}
 \Large \sum_{i=1}^n (x_i - \mu_x)(y_i - \mu_y)
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
<center>
<img src="Shapes%202.png" style="width:90.0%" />
</center>
<ol start="4" style="list-style-type: decimal">
<li>We then <strong>divide the sum of the crossproduct by N (or N-1 in sample)</strong> so that we have taken into account how many observations contributed to this quantity. This final number is called the <strong>covariance</strong>, and its value tells us how much our two variables fluctuate together. The higher the absolute value of the covariance is, the more closely the two variables fluctuates together.</li>
</ol>
<p>The equation for the covariance (abbreviated cov) of the variables x and y is shown below. As a preference of style, we multiply by <span class="math inline">\(\frac{1}{N}\)</span> instead of dividing the entire term by <span class="math inline">\(N\)</span>.</p>
<div style="margin-bottom:50px">

</div>
<span class="math display" id="eq:equation3">\[\begin{equation}
 \tag{3}
 \Large cov(x,y) = {\frac{1}{N}\sum_{i=1}^N (x_i - \mu_x)(y_i - \mu_y)}
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
</div>
<div id="problem-of-interpretation" class="section level2">
<h2>Problem of interpretation</h2>
<p>However, the covariance is not an intuitive value. Remember that we have been working with terms that are on the squared scale, which is not only difficult to interpret (just like the variance was) but it is also is the product of two variables on possibly different scales. How could we interpret a covariance with units of millimeters^2 * grams^2 mean?</p>
<p>Another point to make is that value of the covariance will be vastly different if we had decided to change the units (mm vs cm, or g vs kg).</p>
<p>As a result, the covariance is not an easy metric to work with or to compare with other covariances. So, we need to standardize it!</p>
</div>
</div>
<div id="pearson-correlation-coefficient-r" class="section level1">
<h1>Pearson correlation coefficient, <span class="math inline">\(r\)</span></h1>
<div id="how-do-we-standardize-the-covariance" class="section level2">
<h2>How do we standardize the Covariance?</h2>
<p>We need to rescale the covariance to fall within the boundaries of 0 and the maximum spread of the data with respect to their means. <strong>THIS SENTENCE MAY NOT BE TRUE</strong></p>
<p>The solution is to (1) take the standard deviations of each variable, (2) multiply them together, and (3) divide the covariance by this product – the resulting value is called the <strong>Pearson correlation coefficient</strong>. When referring to the population correlation coefficient, the symbol <span class="math inline">\(\rho\)</span> (pronounced “rho”) is used. When referring to the sample correlation coefficient, a lowercase <span class="math inline">\(r\)</span> is used (often called “Pearson’s r”).</p>
The equations for correlation are shown below:
<div style="margin-bottom:50px">
<p><strong>Population correlation</strong></p>
</div>
<span class="math display" id="eq:equation4">\[\begin{equation}
 \tag{4}
 \Large \rho(x,y) = \frac{ \frac{1}{N} \sum_{i=1}^N (x_i - \mu_x)(y_i - \mu_y)}{\sigma_x \sigma_y}
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
<div style="margin-bottom:50px">

</div>
<strong>Sample correlation</strong>
<span class="math display" id="eq:equation5">\[\begin{equation}
 \tag{5}
 \Large r(x,y) = \frac{ \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{s_x s_y}
 \end{equation}\]</span>
<div style="margin-bottom:50px">

</div>
</div>
</div>
<div id="what-the-does-correlation-mean" class="section level1">
<h1>What the does correlation mean?</h1>
<p>We can interpret the correlation as a measure of <strong>the strength and direction</strong> of the relationship between two variables. It is a “standardized” version of the covariance.</p>
<ul>
<li>The correlation will always be between -1 and 1. At these extreme the values, the two variables have the strongest relationship possible, in which each data point will fall exactly on a line. When the absolute value of the correlation coefficient approaches 0, this implies that the observations are more “scattered”.</li>
<li>The sign of the correlation coefficient indicates the direction of the linear relationship. When <span class="math inline">\(r\)</span>= 0 there is no relationship between the variables. Look at the figure below to see what observations of different <span class="math inline">\(r\)</span> values look.</li>
</ul>
<center>
<img src="diff_corr.png" style="width:90.0%" />
</center>
</div>
<div id="code-it-up" class="section level1">
<h1>Code it up</h1>
<p>In the window below, write your own function to compute the sample covariance of two variables, and call it <code>my_covariance( )</code>. Then create a second function called <code>my_correlation( )</code> in which you will compute the correlation of two variables. You may incorporate your function <code>my_covariance( )</code> into this section to save yourself some steps.</p>
<p>You will need to write both functions so that they will take two parameters. The parameters for <code>my_covariance( )</code> have been setup for you.</p>
<div data-datacamp-exercise="" data-height="400" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6InNldC5zZWVkKDEyKVxuaGVpZ2h0c19pc2xhbmQxIDwtIHJub3JtKDUwLDEwLDIpIiwic2FtcGxlIjoibXlfY292YXJpYW5jZSA8LSBmdW5jdGlvbih4LHkpe1xuXG4gIHJldHVybiggKVxufVxuXG5teV9jb3JyZWxhdGlvbiA8LSBmdW5jdGlvbih4LHkpe1xuXG4gcmV0dXJuKCApXG59Iiwic29sdXRpb24iOiJteV9jb3ZhcmlhbmNlIDwtIGZ1bmN0aW9uKHgseSl7XG4gIG1feCA8LSBtZWFuKHgpXG4gIG1feSA8LSBtZWFuKHkpXG5cbiAgZGV2aWF0aW9uX3ggPC0geCAtIG1feFxuICBkZXZpYXRpb25feSA8LSB5IC0gbV95XG4gIFxuICBjcm9zc3Byb2R1Y3QgPC0gZGV2aWF0aW9uX3ggKiBkZXZpYXRpb25feVxuXG4gIGNvdmFyaWFuY2UgPC0gIGNyb3NzcHJvZHVjdCAvIChsZW5ndGgoeCktMSkgIyBEaXZpZGVzIGJ5IE4tMVxuICByZXR1cm4oY292YXJpYW5jZSlcbn1cblxubXlfY29ycmVsYXRpb24gPC0gZnVuY3Rpb24oeCx5KXtcbiBjb3JyZWxhdGlvbiA8LSBteV9jb3ZhcmlhbmNlKHgseSkgLyAoc2QoeCkqc2QoeSkpXG4gcmV0dXJuKGNvcnJlbGF0aW9uKVxufSJ9
</div>
<p>Wow, you can see that there is a negative relaionship between giraffe heights and how much celery giraffes eat. Could this be due to celery being a negative calorie vegetable? Are teacup giraffes onto something here?</p>
<center>
<img src="Celery.png" style="width:50.0%" />
</center>
</div>
<div id="the-standardizer" class="section level1">
<h1>The Standardizer</h1>
<p>You can take a look at the illustration below to see a conceptual summary of how correlation will standarize the covariance, translating it into an easily interpretable metric that will always be bound by -1 and 1.</p>
<div class="figure">
<img src="Factory.png" />

</div>
</div>
<div id="why-divide-by-sigma_xsigma_y" class="section level1">
<h1>Why divide by <span class="math inline">\(\sigma_x\sigma_y\)</span>?</h1>
<p>Well it’s complicated, but it builds on the mathematical principle that the covariance of x and y will never exceed the product of the standard deviations of x and y. This means that the maximum correlation value will occur when the absolute value of the covariance and the product of the standard deviations are equal.</p>
<p>If you don’t take our word for it, press play below to see what the relationship between <span class="math inline">\({s}_x{s}_y\)</span> and <span class="math inline">\({cov(x,y)}\)</span> looks like.</p>
<center>
<iframe style="margin: 0;" src="cov_vs_sxsy.html" width="720" height="500" scrolling="yes" seamless="seamless" frameBorder="0">
</iframe>
</center>
<p>As you look at the plot above, you may have the following questions: * Why are there clearly defined boundaries? + Because at the edges is where the covariance is the greatest value that it can be– it is equal to the product of the standard deviations there. + The slope is 1 at this boundary.</p>
<ul>
<li>Where in the plot do the strongest correlations end up?
<ul>
<li>On the edges – when the absolute value of the numerator and denominator of the equation are equal– the quotient will = 1 (or negative 1, depending on the sign of the covariance in the numerator).</li>
</ul></li>
</ul>
<p><strong>[Another piece of the puzzle involves the fact that the correlation is a scaleless value.]</strong></p>
</div>
<div id="things-to-think-about" class="section level1">
<h1>Things to think about</h1>
<div id="correlation-does-not-capture-relationships-that-are-not-linear" class="section level2">
<h2>Correlation does not capture relationships that are not linear</h2>
<p>If the relationship is not linear, then correlation will not be meaningful. Check out the plot below. There is a clear U-shaped relationship between the two variables, but the correlation coefficient for these data is very close to 0. To meausure non-linear relationships a different metric must be used.</p>
<center>
<img src="corr_curve.png" style="width:60.0%" />
</center>
</div>
<div id="correlation-is-not-causation" class="section level2">
<h2>Correlation is not causation</h2>
<p>Just because there is a linear relationship between two variables does not mean we have evidence that one variable causes the other. Even if there really was a cause-and-effect relationship, with correlation we cannot say which variable is the cause and which is the effect. It’s also possible that there exists some other unmeasured variable affecting the linear relationship we observe. And of course, any apparent relationship may be due to nothing more than random chance.</p>
</div>
</div>

<!DOCTYPE html>

<div class="foot">
	<hr /> 
	<p> Created using </p>
	<img class="foot_image" src="https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg">
	<img class="foot_image" src="https://bookdown.org/yihui/rmarkdown/images/hex-rmarkdown.png">
	<img class="foot_image" src="https://www.rstudio.com/wp-content/uploads/2014/06/RStudio-Ball.png">
</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
